var knownFilters=[];Dropzone.autoDiscover=!1;$(function(){$("#image-dropzone").dropzone({maxFiles:2E3,url:"/ajax_file_upload_handler/",success:function(a,b){console.log(b)}});$("#image-dropzone").sortable({items:".dz-preview",cursor:"move",opacity:.5,containment:"#image-dropzone",distance:20,tolerance:"pointer",dictDefaultMessage:"test test"});$("#selectedtags").selectize({plugins:["remove_button"],delimiter:" ",persist:!1,create:function(a){return{value:a,text:a}}});AddNewPostFilterSearch()});
function GetPostFilters(a,b){console.log("this");$.get("/api/filter/search/"+a,{search:a},function(a){console.log(a);b({})})}function AddOptions(a){var b=$("#selectedfilters")[0].selectize;$.get("/api/filter/search/"+a,{search:a},function(a){0==a.error&&($.each(a.data,function(a,e){knownFilters.push(e);console.log("adding: ",e.name);b.addOption({text:e.name,value:e.name})}),b.refreshOptions(),console.log(a))})}
function FilterSelected(a,b){console.log(a);console.log(b);var d=$.grep(knownFilters,function(b,c){console.log(b,c);return b.name==a})[0],c=$("#selectedtags")[0].selectize;$.each(d.requiredTagNames,function(a,b){c.addOption({text:b,value:b});c.refreshOptions();c.addItem(b);console.log("adding ",b," to tagSelect")});c.refreshOptions();UpdateFilterStyles()}
function SetBanned(a,b){console.log("this ",a,b);var d=$("#selectedfilters")[0].selectize,c=$("#selectedtags")[0].selectize,d=d.getItem(a),c=c.getItem(b);$(c).addClass("banned");$(d).addClass("banned")}
function UpdateFilterStyles(){var a=$("#selectedfilters")[0].selectize,b=$("#selectedtags")[0].selectize,d=a.getValue().split(" "),c=b.getValue().split(" ");$.each(d,function(b,d){var e=$.grep(knownFilters,function(a,b){return a.name==d})[0];a.getItem(d).removeClass("banned");void 0===e&&console.log("couldnt find filter: ",d);$.each(e.bannedTagNames,function(a,b){$.each(c,function(a,c){b==c&&SetBanned(d,c)})})})}
function AddNewPostFilterSearch(){$("#selectedfilters").selectize({plugins:["remove_button"],delimiter:" ",persist:!1,create:!1,onType:AddOptions,onItemAdd:FilterSelected})}function UpdateFilterSelect(a){var b=$("#filterselect");$.each(a.data,function(a,c){knownFilters.push(c);b.append('<option value="'+c.name+'">'+c.name+"</option>");b.trigger("chosen:updated")})};
